<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Arreglos</title>

        <link rel="stylesheet" href="CSS/arreglos.css">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

        <!-- Matomo -->
        <script>
            var _paq = window._paq = window._paq || [];
            /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
            _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
            _paq.push(["setCookieDomain", "*.35.169.201.141"]);
            _paq.push(["setDomains", ["*.35.169.201.141","*.ec2-35-169-201-141.compute-1.amazonaws.com"]]);
            _paq.push(['trackPageView']);
            _paq.push(['enableLinkTracking']);
            (function() {
            var u="//98.85.171.158/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '4']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
            })();
        </script>
        <!-- End Matomo Code -->
    </head>

    <body>
        <div class="logo-container">
            <div class="d-flex justify-content-start">
                <img src="Recursos/UDABERRI_LOGOA.png" alt="Logo">
            </div>
        </div>

        <div class="content-wrapper">
            <div class="container my-4">
                <!-- Tab -->
                <div class="d-flex mb-4">
                    <button class="btn btn-outline-success tab-button me-2 fw-bold rounded-pill">
                        <a href="home.html" class="text-success">Seguimiento</a>
                    </button>
                    <button class="btn btn-success tab-button fw-bold rounded-pill">Arreglos</button>
                </div>

                <!-- Partes de arriba -->
                <div class="section" id="partes-arriba">
                    <h5 class="fw-bold mb-3">Partes de arriba</h5>
                    <div class="square-item">
                        <a href="#" class="square-link" onclick="showConfirmation(this)">
                            <div class="bg-light rounded-3 p-3 mb-3 d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-dark-black">Blusa blanca</span>
                                <span class="text-muted">3</span>
                            </div>
                        </a>
                    </div>
                    <div class="square-item">
                        <a href="#" class="square-link" onclick="showConfirmation(this)">
                            <div class="bg-light rounded-3 p-3 mb-3 d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-dark-black">Blusa blanca</span>
                                <span class="text-muted">7</span>
                            </div>
                        </a>
                    </div>
                    <div class="square-item">
                        <a href="#" class="square-link" onclick="showConfirmation(this)">
                            <div class="bg-light rounded-3 p-3 mb-3 d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-dark-black">Chaleco color</span>
                                <span class="text-muted">1</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Partes de abajo -->
                <div class="section" id="partes-abajo">
                    <h5 class="fw-bold mb-3">Partes de abajo</h5>
                    <div class="square-item">
                        <a href="#" class="square-link" onclick="showConfirmation(this)">
                            <div class="bg-light rounded-3 p-3 mb-3 d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-dark-black">Falda</span>
                                <span class="text-muted">6</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Complementos -->
                <div class="section" id="complementos">
                    <h5 class="fw-bold mb-3">Complementos</h5>
                    <div class="square-item">
                        <a href="#" class="square-link" onclick="showConfirmation(this)">
                            <div class="bg-light rounded-3 p-3 mb-3 d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-dark-black">Pañuelo</span>
                                <span class="text-muted">1</span>
                            </div>
                        </a>
                    </div>
                </div>

                
            </div>
        </div>

        <!-- Overlay de confirmación -->
        <div class="overlay" id="confirmationOverlay">
            <div class="confirmation-box">
                <p class="fw-bold mb-1 h5 text-success">¿Se ha realizado el arreglo?</p>
                <div class="confirmation-buttons">
                    <button class="btn btn-outline-success tab-button me-2 fw-bold rounded-pill" onclick="hideConfirmation()">No</button>
                    <button class="btn btn-success tab-button fw-bold rounded-pill" onclick="confirmDelete()">Si</button>
                </div>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="d-flex justify-content-around align-items-center bg-white fixed-bottom py-3 bottom-nav">
            <div class="flex-fill text-center">
                <a href="nuevo_elemento.html"><img src="Recursos/elemento.png" alt="nuevo elemento" style="height: 24px; width: auto;"></a>
            </div>
            <div class="flex-fill text-center">
                <a href="inventario.html"><img src="Recursos/inventario.png" alt="inventario" style="height: 24px; width: auto;"></a>
            </div>
            <div class="flex-fill text-center">
                <a href="home.html"><img src="Recursos/home_selected.png" alt="home" style="height: 24px; width: auto;"></a>
            </div>
            <div class="flex-fill text-center">
                <a href="buscar.html"><img src="Recursos/buscar.png" alt="buscar" style="height: 24px; width: auto;"></a>
            </div>
            <div class="flex-fill text-center">
                <a href="nueva_actuación.html"><img src="Recursos/nuevo.png" alt="nuevo" style="height: 24px; width: auto;"></a>
            </div>
        </div>

        <!-- Mensaje final cuando no quedan arreglos -->
        <div id="mensaje-final-arreglos" style="display:none; text-align:left; color:#5DB22F; font-size:3rem; font-weight:700; margin-top:2rem; margin-left:1.2rem;">
            ¡No quedan arreglos pendientes!
        </div>

        <script>
            let currentSquare = null;

            function showConfirmation(element) {
                event.preventDefault();
                currentSquare = element.closest('.square-item');
                document.getElementById('confirmationOverlay').style.display = 'flex';
            }

            function hideConfirmation() {
                document.getElementById('confirmationOverlay').style.display = 'none';
                currentSquare = null;
            }

            function confirmDelete() {
                if (currentSquare) {
                    const section = currentSquare.closest('.section');
                    currentSquare.remove();
                    
                    // Verificar si quedan cuadrados en la sección
                    const remainingSquares = section.querySelectorAll('.square-item');
                    if (remainingSquares.length === 0) {
                        const sectionTitle = section.querySelector('h5');
                        if(sectionTitle) sectionTitle.remove();
                    }
                    // Verificar si quedan arreglos en todo el documento
                    if (document.querySelectorAll('.square-item').length === 0) {
                        document.getElementById('mensaje-final-arreglos').style.display = 'block';
                    }
                    hideConfirmation();
                }
            }

            // Selección de bailes y personas
            document.querySelectorAll('.categoria-item').forEach(function(item) {
                item.addEventListener('click', function() {
                    item.classList.toggle('selected');
                });
            });
        </script>
    </body>
</html>
